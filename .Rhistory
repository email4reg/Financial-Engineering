library(quantmod)
getSymbols(c("AAPL","MSFT","GOOG"),from = "2018-01-01",to = "2019-01-01",return.class = 'data.frame',env = parent.frame())
#df_volume=cbind(Vo(AAPL),Vo(MSFT),Vo(GOOG))
df_close=as.data.frame(cbind(Cl(AAPL),Cl(MSFT),Cl(GOOG)))
View(df_close)
colnames(df_close)[1]='AAPL'
colnames(df_close)[2]='MSFT'
colnames(df_close)[3]='GOOG'
stockmann_May=read.delim("C:/Users/sdas/Desktop/database_source/sellout_data/stockmann/latest_month/Monthly sales Item level_101243 FISKARS FINLAND OY AB_01.06.2019.txt")
stockmann_May$Month='05'
stockmann_Jun=read.delim("C:/Users/sdas/Desktop/database_source/sellout_data/stockmann/latest_month/Monthly sales Item level_101243 FISKARS FINLAND OY AB_01.07.2019.txt")
stockmann_Jun$Month='06'
stockmann_staging=rbind(stockmann_May,stockmann_Jun)
stockmann_staging$EAN=as.character(stockmann_staging$EAN)
stockmann_staging$Year='2019'
stockmann_staging$`Year-Month`=paste(stockmann_staging$Year,'-',stockmann_staging$Month)
stockmann_staging$store_name='STKMN'
stockmann_staging$Team='Stockmann'
library(RMySQL)
mydb = dbConnect(MySQL(), user='root', password='Fiskars', dbname='staging', host='localhost')
mydb = dbConnect(MySQL(), user='root', password='Fiskars', dbname='staging', host='localhost')
dbWriteTable(mydb, "stockmann_staging", stockmann_staging)
View(stockmann_staging)
dbWriteTable(mydb, "stockmann_staging", stockmann_staging)
knitr::opts_chunk$set(echo = TRUE)
library(RMySQL)
library(dplyr)
library(kableExtra)
library(knitr)
library(plotly)
library(officer)
library(flextable)
mydb_dim = dbConnect(MySQL(), user='root', password='Fiskars', dbname='su_fin', host='localhost')
dimmaterialmaster= dbSendQuery(mydb_dim, "select * from materialmasterdata;")
materialmaster=fetch(dimmaterialmaster, n=-1)
stockmannsellout= dbSendQuery(mydb_selllout, "select * from fin_sellout.dummy_stockmann ;")
mydb_selllout = dbConnect(MySQL(), user='root', password='Fiskars', dbname='fin_sellout', host='localhost')
stockmannsellout= dbSendQuery(mydb_selllout, "select * from fin_sellout.dummy_stockmann ;")
stockmann=fetch(stockmannsellout, n=-1)
View(materialmaster)
df=left_join(stockmann,materialmaster[,c(11,3,4,15:18)],by='EAN')
View(df)
df=left_join(stockmann,materialmaster[,c(11,3,4,16:18)],by='EAN')
View(df)
df=left_join(stockmann[,-c(23,24)],materialmaster[,c(11,3,4,16:18)],by='EAN')
View(df)
library(xlsx)
write.xlsx(df,file = 'C:/Users/sdas/Desktop/projects/stockmann_201701-201906.xlsx')
options(java.parameters ="-Xmx1024m")
library('XLConnect')
write.xlsx(df,file = 'C:/Users/sdas/Desktop/projects/stockmann_201701-201906.xlsx')
colnames(stockmann)
colnames(df)
write.xlsx2(df,file = 'C:/Users/sdas/Desktop/projects/stockmann_201701-201906.xlsx')
options(java.parameters = "-Xmx8g")
write.xlsx2(df,file = 'C:/Users/sdas/Desktop/projects/stockmann_201701-201906.xlsx')
